{% set isEmbeded = isEmbeded() %}
{% extends isEmbeded ? 'base_embeded.html.twig' : 'base.html.twig' %}
{% set specificPage = isEmbeded ? 'embeded' : '' %}

{% block contentclass %}
    {% if isEmbeded %}bg-secondary{% else %}wrap-main-form py-4{% endif %}
{% endblock %}

{% set formHeader = '2fa.login.title'|trans %}

{% block title %}{{ formHeader }} | mintMe{% endblock %}

{% block content %}
    <div class="container text-center">
        <div class="row pt-4 justify-content-center">
            <div class="col-lg-4 col-md-6">
                <div class="card">
                    <div class="card-header">
                        {{ formHeader }}
                    </div>
                    <div class="card-body">
                        {% if authenticationError and 'error.csrf'|trans != authenticationError %}
                            <div class="p-2 mb-2 bg-danger text-center text-white">
                                {{ authenticationError|trans(authenticationErrorData, 'SchebTwoFactorBundle') }}
                            </div>
                        {% endif %}
                        {% block formBody %}
                            <form action="{{ path("2fa_login_check", {'page': specificPage}) }}" method="post">
                                <div class="form-group">
                                    <label for="code">{% trans %}2fa.verification_code{% endtrans %}</label>
                                    <input
                                        type="text" name="{{ authCodeParameterName }}" required="required"
                                        class="form-control form-control-md" id="code" autofocus
                                        >
                                </div>
                                <div class="form-group mb-0" style="line-height: 0.8em;">
                                    <small>
                                        {% trans %}2fa.email_sent{% endtrans %}
                                    </small>
                                </div>
                                {{ block('trusted_device', 'form/fields.html.twig') }}
                                <div class="form-group">
                                    <input
                                        type="submit" id="_submit" name="_submit"
                                        class="btn btn-primary" value="{% trans %}2fa_modal.submit{% endtrans %}"
                                        >
                                </div>
                                {% if isCsrfProtectionEnabled %}
                                    <input type="hidden" name="{{ csrfParameterName }}" value="{{ csrf_token(csrfTokenId) }}">
                                {% endif %}
                            </form>
                        {% endblock %}
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
