{% extends 'base.html.twig' %}

{% block contentClass %}wrap-main-form py-4{% endblock %}

{% set formHeader = 'Two-Factor Authentication' %}

{% block title %}{{ formHeader }} | mintMe{% endblock %}

{% block content %}

    {% if authenticationError %}
        <div class="alert alert-danger my-2" role="alert">
            {{ authenticationError }}
        </div>
    {% endif %}

    <div class="container text-center">
        <div class="row py-3 justify-content-center">
            <div class="col-xs-12 col-lg-10 col-xl-6">
                <div class="card">
                    <div class="card-header">
                        {{ formHeader }}
                    </div>
                    <div class="card-body">
                        {% block formBody %}
                            <form action="{{ path("2fa_login_check") }}" method="post">
                                <div class="form-group">
                                    <label for="code">Two-factor authentication code</label>
                                    <input
                                        type="text" name="{{ authCodeParameterName }}" required="required"
                                        class="form-control form-control-md" id="code" autofocus
                                    >
                                </div>
                                <div class="form-group">
                                    <small>
                                        Enter the code from the two-factor app on your mobile device.
                                        If you've lost your device, you may enter one of your recovery codes.
                                    </small>
                                </div>
                                <div class="form-group">
                                    <input
                                        type="submit" id="_submit" name="_submit"
                                        class="btn btn-primary" value="VERIFY CODE"
                                    >
                                </div>
                            </form>
                        {% endblock %}
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}
