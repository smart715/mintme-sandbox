{# templates/bundles/NelmioApiDocBundle/SwaggerUi/index.html.twig #}

{#
    To avoid a "reached nested level" error an exclamation mark `!` has to be added
    See https://symfony.com/blog/new-in-symfony-3-4-improved-the-overriding-of-templates
#}
{% extends '@!NelmioApiDoc/SwaggerUi/index.html.twig' %}

{% block title %}
    API Documentation | mintMe
{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('build/main.css') }}">
{% endblock stylesheets %}

{% block javascripts %}
    {% apply
        replace({'<script':'<script nonce="' ~ csp_nonce('script') ~ '"'})|
        raw
    %}
    <script src="{{ asset('bundles/nelmioapidoc/swagger-ui/swagger-ui-bundle.js') }}"></script>
    <script src="{{ asset('bundles/nelmioapidoc/swagger-ui/swagger-ui-standalone-preset.js') }}"></script>
    {% include 'scripts.html.twig' %}
    {% endapply %}
{% endblock javascripts %}

{% block swagger_initialization %}
    {% apply
        replace({'<script':'<script nonce="' ~ csp_nonce('script') ~ '"'})|
        raw
    %}
    <script src="{{ asset('bundles/nelmioapidoc/init-swagger-ui.js') }}"></script>
    {% endapply %}
{% endblock swagger_initialization %}

{% block header %}
{% endblock header %}

{% block swagger_ui %}
    {% apply
        replace({'<script':'<script nonce="' ~ csp_nonce('script') ~ '"'})|
        raw
    %}
    <div class="content-wrapper d-flex flex-column">
        {% include 'topnav.html.twig' %}
        <main class="flex-fill content">
            <div class="container-fluid">
                <div class="row pt-5 justify-content-center">
                    <div class="col-12 px-3">
                        <div class="card card-fixed-large mx-auto">
                            <div class="card-header">
                                <h2>API Documentation</h2>
                            </div>
                            <div class="card-body py-2 px-0">
                                <div class="mx-0 px-1 px-sm-4 px-4 mt-4 mb-0 pb-0">
                                    <p>
                                        All requests must be provided with unique API keys or OAuth token, which you can generate in dashboard.<br />
                                        You have to pass API keys with each request in headers as <span class="text-danger">X-API-ID</span> (public)
                                        and <span class="text-danger">X-API-KEY</span> (private) parameters.<br />
                                        Or you have to pass OAuth token with each request in headers as <span class="text-danger">Authorization: Bearer {token}</span> parameter.<br />
                                        You can get OAuth token by sending the request to address: <span class="text-danger">{{ path('fos_oauth_server_token') }}?client_id={YOUR_CLIENT_ID}&grant_type=client_credentials&client_secret={YOUR_SECRET}</span><br />
                                        Token will expire after some time. You should get token again after expiration.
                                        Our data is delivered to you on-demand using well-documented and simple HTTP RESTful API in JSON format.
                                    </p>
                                    <p>
                                        Requests to API are limited to 5 per second with bursts not exceeding 10 requests.
                                        All requests above this limit won't be processed and API will return 503 HTTP code.
                                        To avoid exceeding the limit, it's recommended to implement a caching mechanism in your application.
                                    </p>
                                    <p>
                                        {% if app.user is not null %}
                                            Go to <a href="{{ path('settings') }}">settings</a> to generate your own API keys or OAuth Client ID and Secret.
                                        {% else %}
                                            <a href="{{ path('login') }}">Log in</a> to generate your own API keys or OAuth Client ID and Secret.
                                        {% endif %}
                                    </p>
                                    <p>
                                        You can test our API here. Authorize your generated keys or token and click on specific methods to see how they work live.
                                    </p>
                                </div>
                                {{ parent() }}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        {% include 'footer.html.twig' %}
    </div>
    {% endapply %}
{% endblock %}

{% block meta %}
    {% apply
        replace({'<script':'<script nonce="' ~ csp_nonce('script') ~ '"'})|
        raw
    %}
    {% include 'head.html.twig' %}
    {% endapply %}
{% endblock %}
