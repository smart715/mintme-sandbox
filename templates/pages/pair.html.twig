{% extends 'base.html.twig' %}

{% block title %}mintMe | Token{% endblock %}

{% block content %}
    <div id="token" class="container">
        <div class="row pt-5 justify-content-center">
            <div class="col-md-10" v-cloak>
                {{ include("loader.html.twig", {vCloak: 'v-cloak--block'}) }}
                <b-tabs no-key-nav :lazy="true" @input="onTabUpdated" class="tabs-theme transparent" v-model="tabIndex">
                    <b-tab title="Trade" {% if tab|default and tab == 'trade' %} {{ 'active' }} {% endif %}>
                        <trade
                            websocket-url="{{ global_websocket_url }}"
                            hash="{{ hash }}"
                            login-url="{{ path('fos_user_security_login') }}"
                            signup-url="{{ path('fos_user_registration_register') }}"
                            :market="{{ market | json_encode }}"
                            :logged-in="{{ app.user ? 'true' : 'false' }}"
                            :is-owner="{{ isOwner ? 'true' : 'false' }}"
                            :precision="{{ precision }}"
                            :is-owner="{{ isOwner ? 'true' : 'false' }}"
                            :user-id="{{ app.user ? app.user.id : 0 }}">
                        </trade>
                    </b-tab>
                    {% if showIntro %}
                        <b-tab title="Introduction" {% if tab == 'intro' %} {{ 'active' }} {% endif %}>
                            <div class="row">
                                <token-introduction-profile
                                    class="col-12 col-lg-4 pr-lg-2"
                                    youtube-client-id="{{ global_youtube_client_id }}"
                                    facebook-app-id="{{ global_facebook_app_id }}"
                                    confirm-website-file-url="{{ path('token_website_confirmation', {'name': market.quote.name}) }}"
                                    confirm-website-url="{{ path('token_website_confirm', {'name': market.quote.name}) }}"
                                    profile-name="{{ profile.firstName }} {{ profile.lastName }}"
                                    website-url="{{ token.websiteUrl }}"
                                    facebook-url="{{ token.facebookUrl }}"
                                    youtube-channel-id="{{ token.youtubeChannelId }}"
                                    update-url="{{ path('token_update', {'name': market.quote.name}) }}"
                                    :editable="{{ isOwner ? 'true' : 'false' }}"
                                    profile-url="{{ absolute_url(path('profile-view', { 'pageUrl': token.getProfile().getPageUrl() })) }}"
                                >
                                </token-introduction-profile>

                                <token-introduction-statistics
                                    class="col-12 col-lg-4 pt-3 pt-lg-0 px-lg-2"
                                    :market="{{ market | json_encode }}"
                                    :editable="{{ isOwner ? 'true' : 'false' }}"
                                    release-period-route="{{ path('lock_in', {'name': market.quote.name}) }}"
                                    :precision="{{ precision }}">
                                </token-introduction-statistics>
                                <token-introduction-description
                                    class="col-12 col-lg-4 pt-3 pt-lg-0 pl-lg-2"
                                    @updated="descriptionUpdated"
                                    name="{{ token.name }}"
                                    :description="tokenDescription"
                                    update-url="{{ path('token_update', {'name': market.quote.name}) }}"
                                    :editable="{{ isOwner ? 'true' : 'false' }}">
                                </token-introduction-description>
                            </div>
                        </b-tab>
                    {% endif %}
                    <template slot="tabs">
                        <b-nav-item class="float-sm-right" @click="()=>{}">
                            <token-name
                                name="{{ market.quote.name }}"
                                update-url="{{ path('token_update', {'name': market.quote.name}) }}"
                                :editable="{{ isOwner ? 'true' : 'false' }}">
                            </token-name>
                        </b-nav-item>
                        <div class="clearfix"></div>
                    </template>
                </b-tabs>
            </div>
        </div>
        {% if token|default %}
            <input type="hidden" v-model="tokenDescription" :set-value="tokenDescription = tokenDescription || '{{ token.description }}'" />
        {% endif %}
    </div>

    <input type="hidden" id="confirm-website-url" value="{{ path('token_website_confirm', {'name': market.quote.name}) }}">
{% endblock %}

{% block pagescripts %}
    <script src="https://apis.google.com/js/platform.js"></script>
    <script src="https://apis.google.com/js/api.js"></script>
    <script src="{{ asset('build/pair.js') }}"></script>
{% endblock %}
